---
title: Mass Assignment -> Vertical Privilege Escalation
date: 2022-01-01 05:49:33 +0800
categories: [WebApp And Api Pentesting, Mass Assignmen -> Vertical Privilege Escalation]
tags: []  
---

# Mass Assignment -> Vertical Privilege Escalation

# Exploitation

![mass](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/mass1.png)

This webaapp is vulnerable to mass assignment which will allow attacker to register as `admin`. 

We will first register as normal user to see how the application is working.

![mass](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/mass2.png)

Let's submit the registration form

![mass](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/mass3.png)

As you can see , we have registered as normal user but our goal here is to register as admin.

To do that, we will fill the registration form and intercept the request in burpsuite.

![mass](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/mass4.png)

The application was submitting this `user[username]=user2&user[password]=user2`.

What if there exist an admin attribute? If so, we can overwrite the admin attribute by adding either `user[admin]=1` or `user[admin]=true` to our request.

Let's try this trick with this payload `user[username]=user2&user[password]=user2&user[admin]=1`

![mass](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/mass5.png)

![mass](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/mass6.png)

Done!.

# References
