---
title: XPATH Injection
date: 2022-01-01 05:49:33 +0800
categories: [WebApp And Api Pentesting, XPATH Injection]
tags: [webapp, pentesting, Owasp, xpath, injection]     # TAG names should always be lowercase
---

# XPATH Injection

# Detection

![xpath](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/xpath1.png)

This webapp will take in the username and password and then passes them to xml, and xml will check the database to determine whether or not they exist. If the webapp is vulnerable to xpath injection, we can bypass the authentication.

Let's try this valid credential that we have been given. `Mike: test123`

![xpath](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/xpath2.png)

We were able to get user's detail with the given credential. But our aim is to login without valid credential.

We will now attempt to determine whether or not it's using xml as it database. Since xpath uses syntax with `/ > < @ \ ..`, we will attempt to supply something containing those characters to see if we can get an error or some anomality.

![xpath](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/xpath0.png)

As you can see we got an error, this means our input broke the xpath, therefore it might be using xpath to process user supplied input.

# Exploitation

To bypass the authentication, we will supply `' or '1'='1` in both username and password fields, If it's successfull, we will be able to retrieve details of others for which we don't hava permission.

![xpath](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/xpath4.png)
