---
title: Broken Authentication -> Forgot Password - Bad Questions
date: 2022-01-01 05:49:33 +0800
categories: [WebApp And Api Pentesting, Broken Authentication -> Forgot Password - Bad Questions]
tags: []  
---

# Broken Authentication -> Forgot Password - Bad Questions

A security question is form of shared secret used as an authenticator. It is used as an extra security layer. 

# Exploitation

![bcf](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/bsf1.png)

This webapp has password recovery with bad security questions inwhich the answers can easily be predicted by attacker.

We will test the webapp with username `webgoat` to understand its working flow.

![bcf](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/bsf2.png)

As you can see, it was asking for favorite color which is bad question as it can be predicted. Since we have been given `red` as the favorite color of `webgoat` user, we will use it here.

![bcf](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/bsf3.png)

![bcf](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/bsf4.png)

Now we have understood the working flow of the password recovery, we are going to reset password of `admin` user.

Let's enter `admin` as the username.

![bcf](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/bsf5.png)

![bcf](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/bsf0.png)

Here, We don't know the favorite color of admin user but since the security question is easy to guess, we can try different color until we get the right one.

Let's test for `red`

![bcf](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/bsf6.png)

red was incorrect. Let's try for `green`

![bcf](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/bsf7.png)

![bcf](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/bsf8.png)

Great!, we have predicted the answer.

# References

- [https://cheatsheetseries.owasp.org/cheatsheets/Choosing_and_Using_Security_Questions_Cheat_Sheet.html](https://cheatsheetseries.owasp.org/cheatsheets/Choosing_and_Using_Security_Questions_Cheat_Sheet.html)
- [https://en.wikipedia.org/wiki/Security_question](https://en.wikipedia.org/wiki/Security_question)
