---
title: Insecure Deserialization 
date: 2022-01-01 05:49:33 +0800
categories: [WebApp And Api Pentesting, Insecure Deserialization ]
tags: []  
---

# Insecure Deserialization 

Insecure deserialization is when user-controllable data is deserialized by a website. This potentially enables an attacker to manipulate serialized objects in order to pass harmful data into the application code. 

# Exploitation

This webapp uses a serialization-based session mechanism and is vulnerable to privilege escalation as a result. We are going to manipulate the serialized object in the session cookie to exploit this vulnerability and gain administrative privileges. 

We will login with the following credentials: `wiener:peter` and then escalate to admin privileges.

![insecdes](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/des1.png)

![insecdes](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/des3.png)

Now we have logged in as `wiener`.

To examine the cookie, we will refresh the page and then intercept the request in burp suite.

![insecdes](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/des4.png)

As you can see from the format of the decoded cookie, it was using serialiazed object as cookie. There was `admin` object with attribute `0` which might define the privileges of a user. Therefore, if it's vulnerable to Insecure Deserialization, we can modify the attribute of `admin` to `1`, which will allow us to login as admin.

![insecdes](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/des5.png)

![insecdes](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/des6.png)

Nice!, `Admin Panel` has appeared, meaning we have admin privileges.

# References

- [https://portswigger.net/web-security/deserialization](https://portswigger.net/web-security/deserialization)
- [https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization](https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization)
