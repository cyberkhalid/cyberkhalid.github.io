---
title: Reflected XSS
date: 2022-01-01 05:49:33 +0800
categories: [WebApp And Api Pentesting, Reflected XSS]
tags: []  
---

# Reflected XSS

Cross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user. Reflected attacks are those where the injected script is reflected off the web server, such as in an error message, search result, or any other response that includes some or all of the input sent to the server as part of the request.

# Exploitation

![xssr](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/xssr1.png)

This webapp takes in user's firstname and lastname and then displays a welcome message on the page.

Let's enter firstname as `exploit` and lastname as `target`.

![xssr](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/xssr2.png)

We got a text saying `welcome exploit target`. Since it was reflecting our inputs back, it might be vulnerable to XSS injection. We can further inspect the page.

![xssr](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/xssr3.png)

Let's inject this xss payload `<a href=javascript:alert(1)>Click</a>` in firstname field and see if we can get alert box.

![xssr](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/xssr4.png)

As you can see, the link has appeared on the page. We will click on the link.

![xssr](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/xssr5.png)

Well, We got alert box.

# Mitigations

- Use HTML entity encoding.
- Use Content Security Policy (CSP).
- Set the HttpOnly flag for cookies.

# References

- [https://owasp.org/www-community/attacks/xss/](https://owasp.org/www-community/attacks/xss/)
- [https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)
- [https://portswigger.net/web-security/cross-site-scripting](https://portswigger.net/web-security/cross-site-scripting)
