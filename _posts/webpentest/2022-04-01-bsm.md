---
title: Broken Authentication -> Account Takeover Via Multistage Login
date: 2022-01-01 05:49:33 +0800
categories: [WebApp And Api Pentesting, Broken Authentication -> Account Takeover Via Multistage Login]
tags: []  
---

# Broken Authentication -> Account Takeover Via Multistage Login

# Exploitation

![bcm](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/bsm1.png)

This webapp has authentication flaw that allows attacker to takeover an account of any registered user. We have been provided with the credential of `Joe` but our goal is to login as `Jane`.

Let's enter the credentials `Joe:banana`, click on submit and then intercept the request in burpsuite.

![bcm](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/bsm2.png)

Nothing interesting here, let's forward the request.

![bcm](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/bsm3.png)

Here we have been asked to enter the value of `Tan #2` which was `4894`. Let's submit and intercept the request in burpsuite.

![bcm](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/bsm4.png)

Well, hidden_user looks interesting target to us, we will replace `Joe` with `Jane` and see if we can login to `Jane` account.

![bcm](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/bsm5.png)

Let's forward the request

![bcm](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/bsm6.png)

Great!, We have takenover jane account.

# References
