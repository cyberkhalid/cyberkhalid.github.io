---
title: Machine Account -> Privileged Group
date: 2022-06-03 05:49:33 +0800
categories: [Infrastructure Pentesting, Active Directory]
tags: []  
---

# Privileged Group

Machine accounts could be added to privileged groups for establishing domain persistence. 

Note: `This is a domain persistence technigue, therefore, assume we have compromised domain administrator's account and we are trying to achieve persistence in the domain.`

# Exploitation

Since we have compromised administrator account, we will create a new machine account using `powermad` and add it to `domain admins` group.

```powershell

new-machineaccount -machineaccount backdoor -domain cyber.local -domaincontroller dc01.cyber.local

```
![ma](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/machineaccount1.png)

![ma](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/machineaccount2.png)

As you can see, we have created new machine `backdoor`.

We will now add the machine to `Domain Admins` group.

![ma](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/machineaccountg1.png)

Our machine account has been added to `Domain Admins`.

We will login to our newly created machine account `backdoor` and get powershell session of the domain controller.

```powershell
runas /netonly /user:cyber.local\backdoor$ cmd.exe

```
![ma](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/machineaccountg3.png)

Done. 

# References

- [https://pentestlab.blog/2022/01/17/domain-persistence-machine-account/](https://pentestlab.blog/2022/01/17/domain-persistence-machine-account/)
