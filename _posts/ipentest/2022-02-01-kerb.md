---
title:  Kerberos Pentesting
date: 2022-06-03 05:49:33 +0800
categories: [Infrastructure Pentesting, Kerberos]
tags: []  
---

# Kerberos

Kerberos is an authentication protocol that is used to verify the identity of a user or host. It runs on port `88/tcp` by default.

# Enumeration

## Scanning With Nmap

We can use nmap to scan kerberos protocol.

```bash

nmap -Pn -sS -sV -p 88 [target_host]

```

![kerb](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/kerb0.png)

Above image shows kerberos was running on port 88/tcp on our target. 

## Username Enumeration

To enumerate usernames, Kerbrute sends TGT requests with no pre-authentication. If the KDC responds with a PRINCIPAL UNKNOWN error, the username does not exist. However, if the KDC prompts for pre-authentication, we know the username exists and we move on. This does not cause any login failures so it will not lock out any accounts.

We can use `kerbrute` to enumerate usernames via kerberos protocol.

```bash

kerbrute userenum -d [domain] --dc [dc_ip] [users_file]

```

![kerb](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/kerb1.png)

As you can see we were able to get valid usernames.

# References

- [https://docs.microsoft.com/en-us/windows-server/security/kerberos/kerberos-authentication-overview](https://docs.microsoft.com/en-us/windows-server/security/kerberos/kerberos-authentication-overview)
- [https://book.hacktricks.xyz/network-services-pentesting/pentesting-kerberos-88](https://book.hacktricks.xyz/network-services-pentesting/pentesting-kerberos-88)
