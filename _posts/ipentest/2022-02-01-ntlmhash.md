---
title: LLMNR/NBT-NS Poisoning 
date: 2022-06-03 05:49:33 +0800
categories: [Infrastructure Pentesting, Active Directory]
tags: []  
---

# LLMNR/NBT-NS Poisoning

By responding to LLMNR/NBT-NS network traffic, adversaries may spoof an authoritative source for name resolution to force communication with an adversary controlled system. This activity may be used to collect or relay authentication materials. 

# Exploitation

For this purpose, we will use `responder` to retrieve the ntlm hash of the victim, and then crack it with `john`.

Let's run our responder to listen for ntlm traffic.

![ntlm](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/smbrelay3.png)

Now we will go to our victim machine and try to access a resources that does not exist.

![ntlm](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/ntlmrelay4.png)

Let's go back to our machine.

![ntlm](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/smbrelay6.png)

As you can see, we have retrieved ntlm hash of administrator. We will save it in a file and crack it using `john`.

![ntlm](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/smbrelay7.png)


# References

- [https://attack.mitre.org/techniques/T1557/001/](https://attack.mitre.org/techniques/T1557/001/)
