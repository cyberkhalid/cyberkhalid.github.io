---
title:  Shell Escape Sequences 
date: 2022-06-03 05:49:33 +0800
categories: [Infrastructure Pentesting, Linux Privilege Escalations]
tags: []  
---

# Shell Escape Sequences 
The sudo command, by default, allows you to run a program with root privileges. Under some conditions, system administrators may need to give regular users some flexibility on their privileges. For example, a junior SOC analyst may need to use Nmap regularly but would not be cleared for full root access. In this situation, the system administrator can allow this user to only run Nmap with root privileges while keeping its regular privilege level throughout the rest of the system.

# Enumeration

We are going to exploit this misconfiguration to escalate our privileges to `root`. Let's check the list of a programs that can be run with root privilege by executing `sudo -l`

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc1.png)

We will be using GTFobins `https://gtfobins.github.io/` to exploit these applications that are set to run with sudo privileges.

# Exploitation

## iftop

Let's check `gtfobins` to see whether there is a way to exploit `iftop` .

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc2.png)

Well..we got it. We will follow the given procedure to exploit it and escalate to `root`.

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc3.png)

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc4.png)

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc5.png)

## find

Let's check `gtfobins` to see whether there is a way to exploit `find` .

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc6.png)

Well..we got it. We will follow the given procedure to exploit it and escalate to `root`.

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc7.png)

## nano

Let's check `gtfobins` to see whether there is a way to exploit `nano` .

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc8.png)

Well..we got it. We will follow the given procedure to exploit it and escalate to `root`.

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc9.png)

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc10.png)

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc11.png)

## vim

Let's check `gtfobins` to see whether there is a way to exploit `vim` .

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc12.png)

Well..we got it. We will follow the given procedure to exploit it and escalate to `root`.

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc13.png)

## man

Let's check `gtfobins` to see whether there is a way to exploit `man` .

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc14.png)

Well..we got it. We will follow the given procedure to exploit it and escalate to `root`.

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc15.png)

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc16.png)

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc17.png)

## awk

Let's check `gtfobins` to see whether there is a way to exploit `awk` .

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc18.png)

Well..we got it. We will follow the given procedure to exploit it and escalate to `root`.

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc19.png)

## less

Let's check `gtfobins` to see whether there is a way to exploit `less` .

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc20.png)

Well..we got it. We will follow the given procedure to exploit it and escalate to `root`.

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc21.png)

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc22.png)

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc23.png)

## ftp

Let's check `gtfobins` to see whether there is a way to exploit `ftp` .

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc27.png)

Well..we got it. We will follow the given procedure to exploit it and escalate to `root`.

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc28.png)

## nmap

Let's check `gtfobins` to see whether there is a way to exploit `nmap` .

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc29.png)

Well..we got it. We will follow the given procedure to exploit it and escalate to `root`.

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc30.png)

## more

Let's check `gtfobins` to see whether there is a way to exploit `more` .

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc31.png)

Well..we got it. We will follow the given procedure to exploit it and escalate to `root`.

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc32.png)

![linpriv](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/linprivshellesc33.png)

 
