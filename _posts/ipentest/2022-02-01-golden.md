---
title: Golden Ticket 
date: 2022-06-03 05:49:33 +0800
categories: [Infrastructure Pentesting, Active Directory]
tags: []  
---

# Golden Ticket 

Is an attack that allows attacker who has `KRBTGT account password hash` to forge Kerberos ticket-granting tickets (TGT) that will enable him to generate authentication material for any account in Active Directory. This ticket is known as `golden ticket`.

# Exploitation

Let's try to get powershell session of domain controller .

![ma](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/golden7.png)

As you can see, we were not able to access it because we didn't have required privileges. Now we will forge the golden ticket to see if we can access it.

To forge golden ticket, we need to get `KRBTGT` password hash using any credential access technigues. We will execute `dcsync attack` to retrieve password hash of KRBTGT.

![ma](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/acluserdcsync4.png)

With the password hash retrieved, we will load mimikatz and forge the golden ticket.

![ma](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/golden3.png)

We will then pass the ticket.

![ma](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/golden4.png)

![ma](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/golden5.png)

Now Let's try to get powershell session of domain controller again.

![ma](https://raw.githubusercontent.com/cyberkhalid/cyberkhalid.github.io/main/assets/img/ipentest/golden6.png)

Great.

# References

- [https://attack.mitre.org/techniques/T1558/001/](https://attack.mitre.org/techniques/T1558/001/)
